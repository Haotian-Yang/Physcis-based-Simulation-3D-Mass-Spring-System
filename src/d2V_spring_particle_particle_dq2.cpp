#include <d2V_spring_particle_particle_dq2.h>

void d2V_spring_particle_particle_dq2(Eigen::Ref<Eigen::Matrix66d> H, Eigen::Ref<const Eigen::Vector3d> q0,  Eigen::Ref<const Eigen::Vector3d> q1, double l0, double stiffness) {
    Eigen::MatrixXd B(q0.rows(), q0.rows()*2);
    Eigen::VectorXd q(6);
    B << -Eigen::MatrixXd::Identity(q0.rows(), q0.rows()), Eigen::MatrixXd::Identity(q0.rows(), q0.rows());
    q << q0(0),q0(1), q0(2), q1(0), q1(1), q1(2);
    H.setZero();
    
    double qBBq = q.transpose()*B.transpose()*B*q;


    //H << (l0*stiffness*0.5)*
    //H << (0.5*pow(qBBq, -3.0/2.0)*(B.transpose()*B*q)*(q.transpose()*B.transpose()*B) + ((1-pow(qBBq, -0.5))*B.transpose()*B));
    //H << ((qBBq - l0)/qBBq) * (B.transpose()*B*q);
    //H << stiffness/pow(qBBq, 1.5)*B.transpose()*B*q*(q.transpose()*B.transpose()*B) - (2*stiffness*(pow(qBBq, 0.5) - l0)/pow(qBBq, 2))*B.transpose()*B*q*(q.transpose()*B.transpose()*B) + stiffness*(pow(qBBq, 0.5) - l0)/qBBq * B.transpose()*B;
    //H(0,0) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(0,1) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(0,2) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(0,3) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(0,4) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(0,5) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,0) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,1) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,2) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,3) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,4) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(1,5) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,0) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,1) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,2) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,3) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,4) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(2,5) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,0) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,1) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,2) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,3) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(0)*2.0+q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,4) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(3,5) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,0) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,1) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,2) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,3) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(1)*2.0+q(4)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,4) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(1)*2.0+q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(4,5) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,0) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,1) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,2) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,3) = (stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(0)*2.0+q(3)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,4) = (stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*(q(1)*2.0+q(4)*2.0)*(q(2)*2.0+q(5)*2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;
    //H(5,5) = -stiffness*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)))+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0))/(q(0)*(q(0)+q(3))*4.0+q(1)*(q(1)+q(4))*4.0+q(3)*(q(0)+q(3))*4.0+q(2)*(q(2)+q(5))*4.0+q(4)*(q(1)+q(4))*4.0+q(5)*(q(2)+q(5))*4.0)+(stiffness*pow(q(2)*2.0+q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5))))*1.0/pow(q(0)*(q(0)+q(3))+q(1)*(q(1)+q(4))+q(3)*(q(0)+q(3))+q(2)*(q(2)+q(5))+q(4)*(q(1)+q(4))+q(5)*(q(2)+q(5)),3.0/2.0))/4.0;



    //H(0,0) = (stiffness*pow(q(0)*2.0-q(3)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(0,1) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(0,2) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(0,3) = (stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(0,4) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(0,5) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,0) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,1) = (stiffness*pow(q(1)*2.0-q(4)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,2) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,3) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,4) = (stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(1,5) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,0) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,1) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,2) = (stiffness*pow(q(2)*2.0-q(5)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,3) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,4) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(2,5) = (stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,0) = (stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,1) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,2) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,3) = (stiffness*pow(q(0)*2.0-q(3)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(0)*2.0-q(3)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,4) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(3,5) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,0) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,1) = (stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,2) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,3) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(1)*2.0-q(4)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,4) = (stiffness*pow(q(1)*2.0-q(4)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(1)*2.0-q(4)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(4,5) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,0) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,1) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,2) = (stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(-1.0/4.0))/(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))-(stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,3) = (stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(0)*2.0-q(3)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,4) = (stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)+(stiffness*(q(1)*2.0-q(4)*2.0)*(q(2)*2.0-q(5)*2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;
    //H(5,5) = (stiffness*pow(q(2)*2.0-q(5)*2.0,2.0))/(q(0)*(q(0)-q(3))*4.0+q(1)*(q(1)-q(4))*4.0-q(3)*(q(0)-q(3))*4.0+q(2)*(q(2)-q(5))*4.0-q(4)*(q(1)-q(4))*4.0-q(5)*(q(2)-q(5))*4.0)-stiffness*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)))+(stiffness*pow(q(2)*2.0-q(5)*2.0,2.0)*(l0-sqrt(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5))))*1.0/pow(q(0)*(q(0)-q(3))+q(1)*(q(1)-q(4))-q(3)*(q(0)-q(3))+q(2)*(q(2)-q(5))-q(4)*(q(1)-q(4))-q(5)*(q(2)-q(5)),3.0/2.0))/4.0;


    H(0,0) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(1)*q(1))+l0*(q(2)*q(2))+l0*(q(4)*q(4))+l0*(q(5)*q(5))-l0*q(1)*q(4)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(0,1) = stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(0,2) = stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(0,3) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(1)*q(1))+l0*(q(2)*q(2))+l0*(q(4)*q(4))+l0*(q(5)*q(5))-l0*q(1)*q(4)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(0,4) = -stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(0,5) = -stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,0) = stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,1) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(2)*q(2))+l0*(q(3)*q(3))+l0*(q(5)*q(5))-l0*q(0)*q(3)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,2) = stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,3) = -stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,4) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(2)*q(2))+l0*(q(3)*q(3))+l0*(q(5)*q(5))-l0*q(0)*q(3)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(1,5) = -stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,0) = stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,1) = stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,2) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(1)*q(1))+l0*(q(3)*q(3))+l0*(q(4)*q(4))-l0*q(0)*q(3)*2.0-l0*q(1)*q(4)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,3) = -stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,4) = -stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(2,5) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(1)*q(1))+l0*(q(3)*q(3))+l0*(q(4)*q(4))-l0*q(0)*q(3)*2.0-l0*q(1)*q(4)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,0) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(1)*q(1))+l0*(q(2)*q(2))+l0*(q(4)*q(4))+l0*(q(5)*q(5))-l0*q(1)*q(4)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,1) = -stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,2) = -stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,3) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(1)*q(1))+l0*(q(2)*q(2))+l0*(q(4)*q(4))+l0*(q(5)*q(5))-l0*q(1)*q(4)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,4) = stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(3,5) = stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,0) = -stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,1) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(2)*q(2))+l0*(q(3)*q(3))+l0*(q(5)*q(5))-l0*q(0)*q(3)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,2) = -stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,3) = stiffness*l0*(q(0)-q(3))*(q(1)-q(4))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,4) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(2)*q(2))+l0*(q(3)*q(3))+l0*(q(5)*q(5))-l0*q(0)*q(3)*2.0-l0*q(2)*q(5)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(4,5) = stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,0) = -stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,1) = -stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,2) = stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(1)*q(1))+l0*(q(3)*q(3))+l0*(q(4)*q(4))-l0*q(0)*q(3)*2.0-l0*q(1)*q(4)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,3) = stiffness*l0*(q(0)-q(3))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,4) = stiffness*l0*(q(1)-q(4))*(q(2)-q(5))*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);
    H(5,5) = -stiffness*(-pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0)+l0*(q(0)*q(0))+l0*(q(1)*q(1))+l0*(q(3)*q(3))+l0*(q(4)*q(4))-l0*q(0)*q(3)*2.0-l0*q(1)*q(4)*2.0)*1.0/pow(q(0)*q(3)*-2.0-q(1)*q(4)*2.0-q(2)*q(5)*2.0+q(0)*q(0)+q(1)*q(1)+q(2)*q(2)+q(3)*q(3)+q(4)*q(4)+q(5)*q(5),3.0/2.0);

    H = -H;

    //Vector3d p1 = u.segment<3>(3*this->springs[i].first);
    //Vector3d p2 = u.segment<3>(3*this->springs[i].second);
  //grad of gravity is 0

}